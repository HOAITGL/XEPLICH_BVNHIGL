{% extends "layout.html" %}
{% block title %}Tạo lịch Ca (kíp) trực{% endblock %}
{% block content %}

<h2>Tạo lịch Ca (kíp) trực theo khoa</h2>

{% if message %}
  <div class="alert alert-danger">{{ message }}</div>
{% endif %}

<form method="POST">
  <label>Chọn khoa:</label>
  <select name="department" required>
    <option value="">-- Chọn khoa --</option>
    {% for dept in departments %}
      <option value="{{ dept }}" {% if dept == selected_department %}selected{% endif %}>{{ dept }}</option>
    {% endfor %}
  </select><br><br>

  <label>Chọn mô hình lịch:</label>
  <select name="model_type" required>
    <option value="2ca3kip" {% if model_type == '2ca3kip' %}selected{% endif %}>2 ca 3 kíp</option>
    <option value="3ca4kip" {% if model_type == '3ca4kip' %}selected{% endif %}>3 ca 4 kíp</option>
    <option value="custom" {% if model_type == 'custom' %}selected{% endif %}>Tuỳ chỉnh theo cấu hình khoa</option>
  </select><br><br>

  {% if selected_config %}
    <div class="alert alert-info">
      <strong>Cấu hình lịch trực:</strong><br>
      Số ca/1 ngày: <strong>{{ selected_config.num_shifts }}</strong><br>
      Số tổ/1 ca: <strong>{{ selected_config.cas_per_shift }}</strong><br>
      Bác sĩ/tổ: <strong>{{ selected_config.doctors_per_ca }}</strong><br>
      Điều dưỡng/tổ: <strong>{{ selected_config.nurses_per_ca }}</strong>
    </div>
  {% endif %}

  <label>Từ ngày:</label>
  <input type="date" name="start_date" value="{{ start_date or '' }}" required><br><br>

  <label>Đến ngày:</label>
  <input type="date" name="end_date" value="{{ end_date or '' }}" required><br><br>

  <button type="submit" class="btn btn-success">Tạo lịch</button>
</form>

{% endblock %}
