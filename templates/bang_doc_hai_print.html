<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>B·∫£ng t√≠nh h∆∞·ªüng m·ª©c ƒë·ªôc h·∫°i</title>
    <style>
        @page {
            size: A4 landscape;
            margin: 2cm 1cm 2cm 2cm;
        }

        body { font-family: Arial, sans-serif; margin: 0; }
        table, th, td { border: 1px solid black; border-collapse: collapse; text-align: center; }
        th, td { padding: 4px; font-size: 13px; }
        .text-bold { font-weight: bold; }
        .italic { font-style: italic; font-weight: normal; }

        .header-table {
            width: 100%;
            margin-bottom: 10px;
        }

        .left-title, .right-title {
            font-size: 14px;
        }

        .left-title {
            text-align: center;
        }

        .right-title {
            text-align: center;
        }

        .underline {
            text-decoration: underline;
        }

        h2.title, h4.title, h5.title {
            text-align: center;
            margin: 6px 0;
        }

        .print-buttons {
            text-align: right;
            margin-bottom: 10px;
        }

        @media print {
            .print-buttons {
                display: none;
            }
        }
    </style>
</head>
<body>

    <div class="print-buttons">
        <a href="/" style="padding: 6px 12px; font-size: 14px; background-color: #ccc; border: none; text-decoration: none; border-radius: 4px;">‚Üê Quay l·∫°i trang ch·ªß</a>
        <button onclick="window.print()" style="padding: 6px 12px; font-size: 14px;">üñ®Ô∏è In b·∫£ng</button>
    </div>

    <table class="header-table" style="border: none;">
        <tr>
            <td class="left-title" style="width: 50%; border: none;">
                B·ªÜNH VI·ªÜN NHI T·ªàNH GIA LAI<br>
                <strong class="underline">KHOA {{ department if department != 'T·∫•t c·∫£' else 'TO√ÄN B·ªÜNH VI·ªÜN' }}</strong>
            </td>
            <td class="right-title" style="width: 50%; border: none;">
                <div><strong>C·ªòNG H√íA X√É H·ªòI CH·ª¶ NGHƒ®A VI·ªÜT NAM</strong></div>
                <div class="underline"><strong>ƒê·ªôc l·∫≠p - T·ª± do - H·∫°nh ph√∫c</strong></div>
                <div class="italic">Gia Lai, ng√†y {{ now.day }} th√°ng {{ now.month }} nƒÉm {{ now.year }}</div>
            </td>
        </tr>
    </table>

    <h2 class="title text-bold">
      B·∫¢NG CH·∫§M C√îNG H∆Ø·ªûNG M·ª®C ƒê·ªòC H·∫†I
      {% if hazard_rate is not none %}
          {{ " %.1f"|format(hazard_rate) }}
      {% endif %}
    </h2>
    <h4 class="title">T·ª´ ng√†y {{ start.strftime('%d/%m/%Y') }} ƒë·∫øn {{ end.strftime('%d/%m/%Y') }}</h4>

    <table style="width: 100%;">
        <thead>
            <tr>
                <th rowspan="2">STT</th>
                <th rowspan="2">H·ªç t√™n</th>
                <th rowspan="2">Ch·ª©c v·ª•</th>
                <th colspan="{{ days_range|length }}">Ng√†y trong th√°ng</th>
                <th rowspan="2">T·ªïng ng√†y</th>
            </tr>
            <tr>
                {% for d in days_range %}
                    <th>{{ "%02d"|format(d.day) }}</th>
                {% endfor %}
            </tr>
        </thead>
        <tbody>
            {% for row in table_data %}
                <tr>
                    <td>{{ loop.index }}</td>
                    <td style="text-align: left;">{{ row.name }}</td>
                    <td style="text-align: left;">{{ row.position }}</td>
                    {% for h in row.daily_hours %}
                        <td>{{ h }}</td>
                    {% endfor %}
                    <td><strong>{{ "%.0f"|format(row.total_days) }} ng√†y</strong></td>
                </tr>
            {% endfor %}
        </tbody>
    </table>

    <!-- Ph·∫ßn ch·ªØ k√Ω cu·ªëi trang -->
    <div style="margin-top: 10px;">
        <table style="width:100%; border: none;">
            <tr>
                <td style="text-align: center; border: none;">
                    NG∆Ø·ªúI L·∫¨P B·∫¢NG<br>(K√Ω, ghi r√µ h·ªç t√™n)
                </td>
                <td style="text-align: center; border: none;">
                    TR∆Ø·ªûNG KHOA<br>(K√Ω, ghi r√µ h·ªç t√™n)
                </td>
		    <td style="text-align: center; border: none;">
                    PH√íNG T·ªî CH·ª®C - HCQT<br>(K√Ω, ghi r√µ h·ªç t√™n)
                </td>
                <td style="text-align: center; border: none;">
                    GI√ÅM ƒê·ªêC<br>(K√Ω, ghi r√µ h·ªç t√™n)
               </td>
            </tr>
        </table>
    </div>
</body>
</html>
