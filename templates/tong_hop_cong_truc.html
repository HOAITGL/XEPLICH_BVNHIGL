{% set thang = start_date.split('-')[1]|int %}
{% set nam = start_date.split('-')[0]|int %}
{% set ngay = current_day %}
<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="UTF-8">
    <title>B·∫£ng t·ªïng h·ª£p c√¥ng tr·ª±c</title>
    <style>
      body { font-family: "Times New Roman", serif; }
      table { width: 100%; border-collapse: collapse; }
      th, td { border: 1px solid black; padding: 5px; text-align: center; }
      .ho-ten { width: 4.5cm; text-align: left; padding-left: 6px; }
      .header { font-weight: bold; text-align: center; margin-top: 10px; width: 100%; display: block; }
      h2.header { text-align: center; margin: 0 auto; }
      .no-border { border: none; }
      .italic { font-style: italic; }
      .signature-block { text-align: center; margin-top: 1cm; }
      .text-start { text-align: left; }
      @media print {
          @page { size: A4 landscape; margin: 1cm 1cm 1cm 1.5cm; }
          button { display: none !important; }
      }
      .print-button { text-align: right; margin-bottom: 5px; }
    </style>
</head>
<body>
<div class="print-button">
    <button onclick="window.print()">üñ®Ô∏è In ngay</button>
</div>

<table style="float: left; width: 50%; text-align: center;">
    <tr><td style="border: none;"><strong>B·ªÜNH VI·ªÜN NHI T·ªàNH GIA LAI</strong></td></tr>
    <tr>
        <td style="border: none;">
            <div style="display: inline-block; border-bottom: 1px solid black;">
                {{ selected_department }}
            </div>
        </td>
    </tr>
</table>

<table style="float: right; width: 50%; text-align: center;">
    <tr><td style="border: none;"><strong>C·ªòNG H√íA X√É H·ªòI CH·ª¶ NGHƒ®A VI·ªÜT NAM</strong></td></tr>
    <tr>
        <td style="border: none;">
            <div style="display: inline-block; border-bottom: 1px solid black;">
                ƒê·ªôc l·∫≠p - T·ª± do - H·∫°nh ph√∫c
            </div>
        </td>
    </tr>
    <tr>
        <td style="border: none;"><span class="italic">Gia Lai, ng√†y {{ current_day }} th√°ng {{ current_month }} nƒÉm {{ current_year }}</span></td>
    </tr>
</table>

<div style="clear: both;"></div>

<h2 class="header">B·∫¢NG T·ªîNG H·ª¢P C√îNG TR·ª∞C TH√ÅNG {{ thang }}/{{ nam }}</h2>
<div class="header">Tr·ª±c {{ '16h' if mode == '16h' else '24h' }}</div>

<table>
    <thead>
        <tr>
            <th rowspan="2">STT</th>
            <th rowspan="2" class="ho-ten">H·ªå T√äN</th>
            <th colspan="2">Tr·ª±c ng√†y th∆∞·ªùng</th>
            <th colspan="2">Tr·ª±c ng√†y ngh·ªâ</th>
            <th colspan="2">Tr·ª±c ng√†y l·ªÖ</th>
            <th rowspan="2">T·ªïng s·ªë<br>ng√†y tr·ª±c</th>
            <th rowspan="2">Ghi ch√∫</th>
        </tr>
        <tr>
            <th>Th∆∞·ªùng</th><th>HSCC</th>
            <th>Th∆∞·ªùng</th><th>HSCC</th>
            <th>Th∆∞·ªùng</th><th>HSCC</th>
        </tr>
    </thead>
    <tbody>
        {% for r in rows %}
        <tr>
            <td>{{ loop.index }}</td>
            <td class="ho-ten">{{ r.user.name }}</td>
            <td>{{ r.detail.get(('th∆∞·ªùng', 'ng√†y_th∆∞·ªùng'), {}).get('so_ngay', 0) }}</td>
            <td>{{ r.detail.get(('HSCC', 'ng√†y_th∆∞·ªùng'), {}).get('so_ngay', 0) }}</td>
            <td>{{ r.detail.get(('th∆∞·ªùng', 'ng√†y_ngh·ªâ'), {}).get('so_ngay', 0) }}</td>
            <td>{{ r.detail.get(('HSCC', 'ng√†y_ngh·ªâ'), {}).get('so_ngay', 0) }}</td>
            <td>{{ r.detail.get(('th∆∞·ªùng', 'ng√†y_l·ªÖ'), {}).get('so_ngay', 0) }}</td>
            <td>{{ r.detail.get(('HSCC', 'ng√†y_l·ªÖ'), {}).get('so_ngay', 0) }}</td>
            <td>{{ r.tong_ngay }}</td>
            <td>{{ r.ghi_chu }}</td>
        </tr>
        {% endfor %}
        <tr style="font-weight: bold;">
            <td colspan="2" class="text-start">T·ªïng c·ªông</td>
            <td>{{ sum_row.detail.get(('th∆∞·ªùng', 'ng√†y_th∆∞·ªùng'), 0) }}</td>
            <td>{{ sum_row.detail.get(('HSCC', 'ng√†y_th∆∞·ªùng'), 0) }}</td>
            <td>{{ sum_row.detail.get(('th∆∞·ªùng', 'ng√†y_ngh·ªâ'), 0) }}</td>
            <td>{{ sum_row.detail.get(('HSCC', 'ng√†y_ngh·ªâ'), 0) }}</td>
            <td>{{ sum_row.detail.get(('th∆∞·ªùng', 'ng√†y_l·ªÖ'), 0) }}</td>
            <td>{{ sum_row.detail.get(('HSCC', 'ng√†y_l·ªÖ'), 0) }}</td>
            <td>{{ sum_row.tong_ngay }}</td>
            <td></td>
        </tr>
    </tbody>
</table>

<table class="no-border" style="width: 100%; margin-top: 0.5cm;">
    <tr class="no-border">
        <td class="no-border signature-block">
            <strong>Ng∆∞·ªùi l·∫≠p b·∫£ng</strong><br>
            <em>(K√Ω, ghi r√µ h·ªç t√™n)</em>
        </td>
        <td class="no-border signature-block">
            <strong>Tr∆∞·ªüng khoa</strong><br>
            <em>(K√Ω, ghi r√µ h·ªç t√™n)</em>
        </td>
        <td class="no-border signature-block">
            <strong>Gi√°m ƒë·ªëc</strong><br>
            <em>(K√Ω, ghi r√µ h·ªç t√™n)</em>
        </td>
    </tr>
</table>

</body>
</html>
