{% extends "layout.html" %}

{% block title %}S·ª≠a l·ªãch tr·ª±c{% endblock %}

{% block content %}
<div class="container mt-4">
  <h2>üóìÔ∏è S·ª≠a l·ªãch tr·ª±c cho {{ user.name }}</h2>

  <form method="post">
    <!-- gi·ªØ kho·∫£ng ng√†y khi submit -->
    <input type="hidden" name="start" value="{{ start }}">
    <input type="hidden" name="end" value="{{ end }}">

    <table class="table table-bordered align-middle">
      <thead class="table-dark">
        <tr>
          <th style="width:140px;">Ng√†y</th>
          <th>Ca tr·ª±c hi·ªán t·∫°i</th>
          <th style="min-width:300px;">Ch·ªçn ca m·ªõi</th>
        </tr>
      </thead>
      <tbody>
        {% for s in schedules %}
        <tr>
          <td>{{ s.work_date.strftime('%d/%m/%Y') }}</td>

          <td>
            {% if s.shift %}
              {{ s.shift.name }}
            {% else %}
              <em>‚Äî ch∆∞a g√°n ca ‚Äî</em>
            {% endif %}
          </td>

          <!-- Quan tr·ªçng: name="shift_{{ s.id }}", selected so v·ªõi s.shift_id -->
          <td>
            <select name="shift_{{ s.id }}" class="form-select form-select-sm">
              {% for sh in shifts %}
                <option value="{{ sh.id }}" {% if sh.id == s.shift_id %}selected{% endif %}>
                  {{ sh.name }}
                </option>
              {% endfor %}
            </select>
          </td>
        </tr>
        {% endfor %}
      </tbody>
    </table>

    <div class="mt-3 d-flex gap-2">
      <button type="submit" class="btn btn-primary">L∆∞u thay ƒë·ªïi</button>
      <a href="{{ url_for('view_schedule',
                          department=user.department,
                          start_date=start,
                          end_date=end) }}"
         class="btn btn-secondary">Quay l·∫°i</a>
    </div>
  </form>
</div>
{% endblock %}
